<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="nc7.mapp.dao.EventApplicationDao">

  <!-- EventApplication 객체를 위한 resultMap 설정 -->
  <resultMap type="nc7.mapp.vo.EventApplication" id="eventApplicationMap">
    <id column="users_no" property="userNo"/>
    <id column="event_no" property="eventNo"/>
    <result column="created_date" property="createdDate"/>
    <result column="state" property="state"/>
  </resultMap>

  <!-- 모든 이벤트 신청 내역 조회 -->
  <select id="findAll" resultMap="eventApplicationMap">
    SELECT users_no, event_no, created_date, state
    FROM event_application
  </select>

  <!-- 특정 사용자의 이벤트 신청 내역 조회 -->
  <select id="findByUserNo" parameterType="integer" resultMap="eventApplicationMap">
    SELECT users_no, event_no, created_date, state
    FROM event_application
    WHERE users_no = #{userNo}
  </select>

  <!-- 특정 이벤트의 신청 내역 조회 -->
  <select id="findByEventNo" parameterType="integer" resultMap="eventApplicationMap">
    SELECT users_no, event_no, created_date, state
    FROM event_application
    WHERE event_no = #{eventNo}
  </select>

  <!-- EventApplication 등록 -->
  <insert id="insert" parameterType="nc7.mapp.vo.EventApplication">
    INSERT INTO event_application(users_no, event_no, created_date, state)
    VALUES (#{userNo}, #{eventNo}, #{createdDate}, #{state})
  </insert>

  <!-- EventApplication 수정 -->
  <update id="update" parameterType="nc7.mapp.vo.EventApplication">
    UPDATE event_application
    SET created_date = #{createdDate},
        state = #{state}
    WHERE users_no = #{userNo}
      AND event_no = #{eventNo}
  </update>

  <!-- EventApplication 삭제 -->
  <delete id="delete" parameterType="map">
    DELETE FROM event_application
    WHERE users_no = #{userNo}
      AND event_no = #{eventNo}
  </delete>

</mapper>
